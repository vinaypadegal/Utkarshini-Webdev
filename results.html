<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles/results.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.13.1/css/all.css" integrity="sha384-xxzQGERXS00kBmZW/6qxqJPyxW3UR0BPsL4c8ILaIWXva5kFi7TxkIIaMiKtqV1Q" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@400;700;900&display=swap" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <title>Results</title>
</head>
<body id="content">
    <div>
        <div class="row">
            <div class="col-md-3 sidebar">
                <img src="images/Add a subheading (1).png" alt="" id="side-img">
                <!-- <p id="download" onclick="javascript:demoFromHTML();">Download as PDF<p>
                <p id="book">Book a session</p> -->
            </div>
            <div class="col-md-9 content-box">
                <h1 class="heading">Analysis Report</h1>
                <h2>Questionnaire Analysis</h2>
                <div class="analysis">
                    <h3>Aptitude Skills<span id="apt-span" style="color: rgb(66, 204, 66);"></span></h3>
                    <div class="progress" style="height: 30px;">
                        <div class="progress-bar progress-bar-danger progress-bar-striped active" role="progressbar" style="width:25%;"></div>
                        <div class="progress-bar progress-bar-warning progress-bar-striped active" role="progressbar" style="width:25%;"></div>
                        <div class="progress-bar progress-bar-info progress-bar-striped active" role="progressbar" style="width:25%;"></div>
                        <div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" style="width:25%;"></div>
                    </div>
                    <div id="apt-pointer" class="pointer-div"><i class="pointer fas fa-hand-pointer fa-3x"></i></div>
                </div>
                <div class="analysis">
                    <h3 id="verbal-h3">Verbal Skills<span id="verbal-span" style="color: rgb(66, 204, 66);"></span></h3> 
                    <div class="progress" style="height: 30px;">
                        <div class="progress-bar progress-bar-danger progress-bar-striped active" role="progressbar" style="width:25%;"></div>
                        <div class="progress-bar progress-bar-warning progress-bar-striped active" role="progressbar" style="width:25%;"></div>
                        <div class="progress-bar progress-bar-info progress-bar-striped active" role="progressbar" style="width:25%;"></div>
                        <div class="progress-bar progress-bar-success progress-bar-striped active" role="progressbar" style="width:25%;"></div>
                    </div>
                    <div id="verbal-pointer" class="pointer-div"><i class="pointer fas fa-hand-pointer fa-3x"></i></div>
                </div>  
                <div class="courses-recom">
                    <h2>Courses Recommended</h2>
                    <div>
                        <ol>
                            <li class="course-li">
                                <h4 id="item1"></h4>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-info"  id="progbar1" role="progressbar" style="width:25%;"></div>
                                </div>
                            </li>
                            <li class="course-li">
                                <h4 id="item2"></h4>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-info"  id="progbar2" role="progressbar" style="width:25%;"></div>
                                </div>
                            </li>
                            <li class="course-li">
                                <h4 id="item3"></h4>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-info"  id="progbar3" role="progressbar" style="width:25%;"></div>
                                </div>
                            </li>
                            <li class="course-li">
                                <h4 id="item4"></h4>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-info"  id="progbar4" role="progressbar" style="width:25%;"></div>
                                </div>
                            </li>
                            <li class="course-li">
                                <h4 id="item5"></h4>
                                <div class="progress">
                                    <div class="progress-bar progress-bar-info"  id="progbar5" role="progressbar" style="width:25%;"></div>
                                </div>
                            </li>
                        </ol>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
    <script type="text/javascript">
        window.onload = function () {
            // retrieve stored data (stored in testpage.js)
            var apt = localStorage.getItem("apt");
            var verbal = localStorage.getItem("verbal");
            var courses = localStorage.getItem("courses"); 
            var tot_sum = localStorage.getItem("totsum");

            // move the thumb pointers to the right location (left = 98.6% will move it to the end of progress bar)
            document.getElementById("apt-pointer").style.left = ((apt/5)*98.6) + '%';
            document.getElementById("verbal-pointer").style.left = ((verbal/5)*98.6) + '%';

            var mycourses = JSON.parse(courses)

            // sort descending
            mycourses.sort(function(a, b){
                return b[1] - a[1]; 
            })

            // set aptitude and verbal results
            document.getElementById("apt-span").innerHTML = "<strong> (" + (apt/5)*100 + "%)</strong>";
            document.getElementById("verbal-span").innerHTML = "<strong> (" + (verbal/5)*100 + "%)</strong>";

            // render recommended courses (i starts from 1 because mycourses[0] will always be ['Courses, Recommendation'] after sorting)
            for(var i=1; i <= 5; ++i){
                document.getElementById("item" + i).innerHTML = mycourses[i][0];  // because after sort, mycourses[0] is always ["courses", "recommendation"]
                document.getElementById("progbar" + i).style.width = Math.round((mycourses[i][1]/tot_sum) * 100) + '%';
                document.getElementById("progbar" + i).innerHTML = Math.round((mycourses[i][1]/tot_sum) * 100) + '%';
            }
        }

        // function demoFromHTML() {
        //     const pdf = new jsPDF({
        //         orientation: "landscape",
        //         unit: "pt",
        //         format: "a4"
        //     });
        // // source can be HTML-formatted string, or a reference
        // // to an actual DOM element from which the text will be scraped.
        // source = $('#content')[0];

        // // we support special element handlers. Register them with jQuery-style 
        // // ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
        // // There is no support for any other type of selectors 
        // // (class, of compound) at this time.
        // margins = {
        //     top: 0,
        //     bottom: 20,
        //     left: 40,
        //     width: 522
        // };
        // // all coords and widths are in jsPDF instance's declared units
        // // 'inches' in this case
        // pdf.fromHTML(
        //     source, // HTML string or DOM elem ref.
        //     margins.left, // x coord
        //     margins.top, { // y coord
        //         'width': margins.width, // max width of content on PDF
        //     },

        //     function (dispose) {
        //         // dispose: object with X, Y of the last line add to the PDF 
        //         //          this allow the insertion of new lines after html
        //         pdf.save('Test.pdf');
        //     }, margins
        // );
    // }
    </script>
</body>
</html>